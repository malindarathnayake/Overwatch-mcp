# Overwatch MCP Server Configuration Example
# Copy this file to config.yaml and fill in your values

server:
  name: "overwatch-mcp-server"
  version: "1.0.0"
  log_level: "info"  # debug | info | warning | error

datasources:
  graylog:
    enabled: true
    url: "${GRAYLOG_URL}"           # e.g., https://graylog.internal:9000 (no /api suffix)
    token: "${GRAYLOG_TOKEN}"       # API token
    timeout_seconds: 30
    verify_ssl: true                # Set to false for self-signed certs
    # Query safety limits
    max_time_range_hours: 24        # Max span between from/to
    default_time_range_hours: 1     # Default if not specified
    max_results: 1000               # Hard cap on returned messages
    default_results: 100            # Default limit
    # Production environment names to filter on (auto-builds filter from known_applications.json)
    production_environments:
      - "prod"
      - "production"
    # Known applications file - auto-builds environment filter from discovered data
    # Generate with: python scripts/discover_applications.py --env
    known_applications_file: "${GRAYLOG_KNOWN_APPS_FILE:-}"
    # Manual filter (only used if known_applications_file not set)
    # default_query_filter: "environment:(prod OR production)"

  prometheus:
    enabled: true
    url: "${PROMETHEUS_URL}"        # e.g., http://prometheus.internal:9090
    timeout_seconds: 30
    verify_ssl: true                # Set to false for self-signed certs
    # Query safety limits
    max_range_hours: 168            # 7 days max for range queries
    max_step_seconds: 3600          # Min granularity 1 hour for large ranges
    max_series: 10000               # Refuse queries returning too many series
    max_metric_results: 500         # Cap for metric list

  influxdb:
    enabled: true
    url: "${INFLUXDB_URL}"          # e.g., https://influxdb.internal:8086
    token: "${INFLUXDB_TOKEN}"
    org: "${INFLUXDB_ORG}"
    timeout_seconds: 60
    verify_ssl: true                # Set to false for self-signed certs
    # Bucket allowlist - queries to unlisted buckets are rejected
    allowed_buckets:
      - "telegraf"
      - "app_metrics"
      - "system_metrics"
    # Query safety
    max_time_range_hours: 168       # 7 days

cache:
  enabled: true
  default_ttl_seconds: 60
  # Per-tool TTL overrides
  ttl_overrides:
    prometheus_metrics: 300         # Metric list changes slowly
    graylog_fields: 300             # Field list changes slowly
